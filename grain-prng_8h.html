<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Lightweight Cryptography Primitives: grain-prng.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Lightweight Cryptography Primitives
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_61f0d87b39da19d95a8733a92902c65f.html">combined</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">grain-prng.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Pseudorandom number generator (PRNG) built around Grain-128.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br/>
</div>
<p><a href="grain-prng_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">State information for a Grain-128 based PRNG.  <a href="uniongrain__prng__state__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a730bd53228545a4a1b9c8ea664ae782c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grain-prng_8h.html#a730bd53228545a4a1b9c8ea664ae782c">grain_prng_add_ident</a> (const unsigned char *data, size_t size)</td></tr>
<tr class="memdesc:a730bd53228545a4a1b9c8ea664ae782c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds unique identification information for this device to the global pool.  <a href="#a730bd53228545a4a1b9c8ea664ae782c">More...</a><br/></td></tr>
<tr class="separator:a730bd53228545a4a1b9c8ea664ae782c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae061b58200d607f5e19db9e91e00df8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grain-prng_8h.html#ae061b58200d607f5e19db9e91e00df8e">grain_prng_init</a> (<a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *state)</td></tr>
<tr class="memdesc:ae061b58200d607f5e19db9e91e00df8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a Grain-128 based PRNG.  <a href="#ae061b58200d607f5e19db9e91e00df8e">More...</a><br/></td></tr>
<tr class="separator:ae061b58200d607f5e19db9e91e00df8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d47fda46ae5cb2605258b6960cecc19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grain-prng_8h.html#a8d47fda46ae5cb2605258b6960cecc19">grain_prng_free</a> (<a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *state)</td></tr>
<tr class="memdesc:a8d47fda46ae5cb2605258b6960cecc19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a Grain-128 based PRNG and destroys all sensitive information.  <a href="#a8d47fda46ae5cb2605258b6960cecc19">More...</a><br/></td></tr>
<tr class="separator:a8d47fda46ae5cb2605258b6960cecc19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c09d3c250850c6a1eecbde723354413"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grain-prng_8h.html#a9c09d3c250850c6a1eecbde723354413">grain_prng_reseed</a> (<a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *state)</td></tr>
<tr class="memdesc:a9c09d3c250850c6a1eecbde723354413"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forces a Grain-128 based PRNG to re-seed from the system TRNG.  <a href="#a9c09d3c250850c6a1eecbde723354413">More...</a><br/></td></tr>
<tr class="separator:a9c09d3c250850c6a1eecbde723354413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305b5cdd7bede01d7184ee94d9168908"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grain-prng_8h.html#a305b5cdd7bede01d7184ee94d9168908">grain_prng_feed</a> (<a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *state, const unsigned char *data, size_t size)</td></tr>
<tr class="memdesc:a305b5cdd7bede01d7184ee94d9168908"><td class="mdescLeft">&#160;</td><td class="mdescRight">Feeds data into a Grain-128 based PRNG state to seed it from other sources besides the system TRNG.  <a href="#a305b5cdd7bede01d7184ee94d9168908">More...</a><br/></td></tr>
<tr class="separator:a305b5cdd7bede01d7184ee94d9168908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9875bd281444b642225fe284900ef63a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grain-prng_8h.html#a9875bd281444b642225fe284900ef63a">grain_prng_fetch</a> (<a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *state, unsigned char *data, size_t size)</td></tr>
<tr class="memdesc:a9875bd281444b642225fe284900ef63a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetches data from a Grain-128 based PRNG state.  <a href="#a9875bd281444b642225fe284900ef63a">More...</a><br/></td></tr>
<tr class="separator:a9875bd281444b642225fe284900ef63a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2518e49ae4cd6ae152f0e0f89e6cadfd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grain-prng_8h.html#a2518e49ae4cd6ae152f0e0f89e6cadfd">grain_prng_generate</a> (unsigned char *data, size_t size)</td></tr>
<tr class="memdesc:a2518e49ae4cd6ae152f0e0f89e6cadfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetches random data using a Grain-128 based PRNG.  <a href="#a2518e49ae4cd6ae152f0e0f89e6cadfd">More...</a><br/></td></tr>
<tr class="separator:a2518e49ae4cd6ae152f0e0f89e6cadfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pseudorandom number generator (PRNG) built around Grain-128. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a730bd53228545a4a1b9c8ea664ae782c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void grain_prng_add_ident </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds unique identification information for this device to the global pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Points to the identification information. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes of identification information.</td></tr>
  </table>
  </dd>
</dl>
<p>The application should use this function at startup to add serial numbers and other unique identification information to the global pool for the PRNG. This data does not need to be secret but can help make the generated output unique for each device.</p>
<dl class="section note"><dt>Note</dt><dd>This function is not thread-safe so it should be called at startup before threads start using the PRNG to generate random data. </dd></dl>

</div>
</div>
<a class="anchor" id="a305b5cdd7bede01d7184ee94d9168908"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void grain_prng_feed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Feeds data into a Grain-128 based PRNG state to seed it from other sources besides the system TRNG. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>PRNG state to be feed new seed data. </td></tr>
    <tr><td class="paramname">data</td><td>Points to the data to be fed into the PRNG state. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes of data to be fed into the PRNG state. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9875bd281444b642225fe284900ef63a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grain_prng_fetch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetches data from a Grain-128 based PRNG state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>PRNG state to fetch data from. </td></tr>
    <tr><td class="paramname">data</td><td>Points to a buffer to receive the generated random data. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes of random data to be generated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero if the PRNG was re-seeded from the system TRNG during the fetch but there is no system TRNG or it has failed. </dd></dl>

</div>
</div>
<a class="anchor" id="a8d47fda46ae5cb2605258b6960cecc19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void grain_prng_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a Grain-128 based PRNG and destroys all sensitive information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>PRNG state to be freed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2518e49ae4cd6ae152f0e0f89e6cadfd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grain_prng_generate </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetches random data using a Grain-128 based PRNG. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Points to a buffer to receive the generated random data. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes of random data to be generated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the PRNG was initialized from system TRNG data, or zero if there is no system TRNG or it has failed.</dd></dl>
<p>This function will create a temporary PRNG state object, seed it from the system TRNG, and then generate <em>size</em> bytes of random data. It is intended for quick one-off generation of random material. </p>

</div>
</div>
<a class="anchor" id="ae061b58200d607f5e19db9e91e00df8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grain_prng_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a Grain-128 based PRNG. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>PRNG state to be initialized.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the PRNG was initialized from system TRNG data, or zero if there is no system TRNG or it has failed.</dd></dl>
<p>This function will fetch fresh data from the system TRNG to prepare the PRNG state to generate random data. </p>

</div>
</div>
<a class="anchor" id="a9c09d3c250850c6a1eecbde723354413"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int grain_prng_reseed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uniongrain__prng__state__t.html">grain_prng_state_t</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forces a Grain-128 based PRNG to re-seed from the system TRNG. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>PRNG state to be re-seeded.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero if the PRNG was re-seeded from system TRNG data, or zero if there is no system TRNG or it has failed. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 21 2021 22:08:37 for Lightweight Cryptography Primitives by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
